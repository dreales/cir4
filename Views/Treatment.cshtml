@inherits Umbraco.Web.Mvc.UmbracoTemplatePage<ContentModels.Treatment>
@using ContentModels = Umbraco.Web.PublishedContentModels
@using Archetype.Models
@{
  Layout = "Master.cshtml";
  List<KeyValuePair<string, string>> accordion = null;
  int i = 0;
  if(Model.Content.HasProperty("accordion")){
    accordion = new List<KeyValuePair<string, string>>();
    ArchetypeModel faqList = Model.Content.GetPropertyValue<ArchetypeModel>("fAQList");
    foreach(ArchetypeFieldsetModel faq in faqList){
      string question = faq.GetValue<string>("question");
      string answer = faq.GetValue<string>("answer");
      accordion.Add(new KeyValuePair<string, string>(question, answer));
    }
  }           
  string heroImageUrl = "https://www.circlehealth.co.uk/media/1702/acl-reconstrution-surgery.jpg"; //default hero image
  if (Model.Content.HasValue("heroImage") == true){
    heroImageUrl = Model.Content.GetPropertyValue<IPublishedContent>("heroImage").Url;
  }
}
<div class="hero-image" style="background-image:url( @heroImageUrl )">
  <div class="dark-overlay text-center">
      <h1>@Model.Content.Name</h1>
  </div>
</div>
<div class="greyback maincontent">
  <div class="container">
    <div class="row">
      <div class="col-md-7">
          @Umbraco.Field("welcomeText", altText:"");
          <div id="accordion">
            @foreach(var panel in Model.Content.GetPropertyValue<ArchetypeModel>("myProperty")){
              i++;
              <div class="card">
                <div class="card-header">
                <h3><a data-toggle="collapse" data-target="#collapse@i" aria-expanded="true" aria-controls="collapseOne">@panel.Key</a></h3>
              </div>
              <div id="collapse@i" class="collapse show" aria-labelledby="headingOne" data-parent="#accordion">
                <div class="card-body">@Html.Raw(panel.Value)</div>
              </div>
            </div>
            }
        </div>
      </div>
      <div class="col-md-5">
        @Umbraco.RenderMacro("renderUmbracoForm", new {FormGuid="87a8b37a-b171-42a0-be1d-3b14737d8c02", FormTheme="", ExcludeScripts="0"})
      </div>
    </div>
  </div>
</div>
<div class="container">
  <div class="row">
    <div class="col">
        
    </div>
  </div>
</div> 
